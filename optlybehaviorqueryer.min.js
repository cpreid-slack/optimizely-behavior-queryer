var behavior=function(){var t=optimizely.get("behavior"),e={general:["type","name","category"],numeric:["time","age","revenue"]},r={numeric:["gt","gte","lt","lte","between"],general:["eq","is","in","contains","exists"]},i=function(t){return e.numeric.indexOf(t)>-1?r.general.concat(r.numeric):r.general},n=function(t){return e.general.indexOf(t)<0&&e.numeric.indexOf(t)<0},o=function(){var e={version:"0.2"};this.set_q_part=function(t,r){e[t]=r},this.delete_q_part=function(t){delete e[t]},this.addFilter=function(t){return"filter"in e||(e.filter=[]),e.filter.push(t),this},this.addSort=function(t){return"sort"in e||(e.sort=[]),e.sort.push(t),this},this.run=function(r,i,n){return r&&i?(this.setAggregator(r),this.pick(i),delete e.sort):"sort"in e||this.orderBy("time","descending"),n&&console.log(e),t.query(e)}};return o.prototype={setAggregator:function(t,e){var r={aggregator:t};for(var i in e||{})r[i]=e[i];return this.set_q_part("reduce",r),this},pick:function(t){return t=n(t)?["tags",t]:[t],this.set_q_part("pick",{field:t}),this},where:function(t,e,r){var o=i(t);if(e=e||"exists",o.indexOf(e)<0)throw"comparator ("+e+") not valid for field: "+t;if("exists"!==e&&void 0===r)throw"you need a value when using comparator: "+e;var a={field:t=n(t)?["tags",t]:[t],comparator:e};return"exists"!==e&&(a.value=r),this.addFilter(a),this},type:function(t){var e={field:["type"],value:t};return t instanceof Array&&(e.comparator="in"),this.addFilter(e),this},orderBy:function(t,e){return this.addSort({field:[t||"time"],direction:e||"descending"}),this}},{find:function(t){var e=new o;return t&&e.type(t),e},findOne:function(t){var e=this.find(t);return e.setAggregator("nth",{n:0}),e}}}();