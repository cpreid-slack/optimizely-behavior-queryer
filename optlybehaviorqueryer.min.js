var behavior=function(){var t=optimizely.get("behavior"),e={general:["type","name","category"],numeric:["time","age","revenue"]},r={numeric:["gt","gte","lt","lte","between"],general:["eq","is","in","contains","exists"]},n=function(t){return e.numeric.indexOf(t)>-1?r.general.concat(r.numeric):r.general},i=function(t){return e.general.indexOf(t)<0&&e.numeric.indexOf(t)<0},o=function(){var e={version:"0.2"};this.set_q_part=function(t,r){e[t]=r},this.addFilter=function(t){return"filter"in e||(e.filter=[]),e.filter.push(t),this},this.addSort=function(t){return"sort"in e||(e.sort=[]),e.sort.push(t),this},this.run=function(r,n,i){return r&&n?(this.setAggregator(r),this.pick(n),delete e.sort):"sort"in e||this.orderBy("time","descending"),i&&console.log(e),t.query(e)}};return o.prototype={setAggregator:function(t,e){var r={aggregator:t};for(var n in e||{})r[n]=e[n];return this.set_q_part("reduce",r),this},pick:function(t){return t=i(t)?["tags",t]:[t],this.set_q_part("pick",{field:t}),this},where:function(t,e,r){if(n(t).indexOf(e)<0)throw"comparator ("+e+") not valid for field: "+t;return t=i(t)?["tags",t]:[t],this.addFilter({field:t,comparator:e,value:r}),this},type:function(t){var e={field:["type"],value:t};return t instanceof Array&&(e.comparator="in"),this.addFilter(e),this},orderBy:function(t,e){return this.addSort({field:[t||"time"],direction:e||"descending"}),this}},{find:function(t){var e=new o;return t&&e.type(t),e},findOne:function(t){var e=this.find(t);return e.setAggregator("nth",{n:0}),e}}}();